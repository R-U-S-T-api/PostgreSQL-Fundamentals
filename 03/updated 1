CREATE TABLE IF NOT EXISTS products (
	product_id SERIAL,
	title VARCHAR(255) NOT NULL DEFAULT 'No title',
	created DATE DEFAULT CURRENT_DATE,
	price NUMERIC CONSTRAINT positive_p CHECK (price > 0),
	discount NUMERIC CHECK (discount > 0),
	CONSTRAINT valid_discount CHECK (price > discount),
	UNIQUE (title, created),	
	PRIMARY KEY (product_id)
);

CREATE TABLE IF NOT EXISTS orders (
	order_id SERIAL PRIMARY KEY,
	product_id INTEGER,
	user_id INTEGER,
	quantity INTEGER, 

	FOREIGN KEY (product_id) REFERENCES products (product_id) on delete restrict,
	FOREIGN KEY (user_id) REFERENCES users (user_id) on delete cascade
);

CREATE TABLE IF NOT EXISTS users (
	user_id SERIAL,
	name VARCHAR (255),
	email VARCHAR (60),
	PRIMARY KEY (user_id)
);

INSERT INTO products (title, price) VALUES ('LG TV', 12_000);
INSERT INTO users(name, email) VALUES ('Ivan', 'ivan@gmail.com');

// delete from products where product_id = 2 // restricted
// dete from users where user_id = 1 // deleted including the order where foreign key is active







